<nav
  class="navbar navbar-expand-lg navbar-dark"
  style="background-color: #7c3aed"
>
  <div class="container">
    <a
      class="navbar-brand brand-logo me-4"
      routerLink="/"
      style="cursor: pointer"
    >
      <span class="hard-text">HARD</span><span class="match-text">MATCH</span>
    </a>

    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNavDropdown"
      aria-controls="navbarNavDropdown"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div
      class="collapse navbar-collapse d-lg-flex align-items-center gap-3"
      id="navbarNavDropdown"
    >
      <ul class="navbar-nav mb-0 d-flex gap-3">
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle category-menu text-white ps-0"
            href="#"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Categorías
          </a>
          <ul class="dropdown-menu">
            @for (category of categories; track $index) {
              <li>
                <a
                  class="dropdown-item"
                  [routerLink]="['/categoria', category]"
                  >{{ category | uppercase }}</a
                >
              </li>
            }
          </ul>
        </li>

        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle category-menu text-white"
            href="#"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Tiendas
          </a>
          <ul class="dropdown-menu">
            @for (store of stores; track $index) {
              <li>
                <a
                  class="dropdown-item d-flex align-items-center gap-2"
                  [routerLink]="['/stores', store.name]"
                >
                  <img
                    [src]="store.logo"
                    width="20"
                    height="20"
                    style="object-fit: contain"
                    alt="logo"
                  />
                  {{ store.name }}
                </a>
              </li>
            }
          </ul>
        </li>
      </ul>

      <form
        class="d-flex flex-grow-1 position-relative my-2 my-lg-0"
        role="search"
      >
        <input
          class="form-control search-input"
          type="search"
          [formControl]="searchQuery"
          placeholder="Buscar productos, marcas y más..."
          aria-label="Search"
        />
        <button
          class="search-icon-btn position-absolute top-50 end-0 translate-middle-y me-3"
          style="border: none; background: transparent"
          type="submit"
          (click)="onSearch()"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="20"
            width="20"
            viewBox="0 0 512 512"
          >
            <path
              fill="#6c757d"
              d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"
            />
          </svg>
        </button>
      </form>

      <div class="d-flex align-items-center gap-3">
        <span
          class="material-symbols-outlined notification-icon"
          [class.has-unread]="hasUnreadNotifications"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasWithBothOptions"
        >
          {{
            hasUnreadNotifications ? "notifications_unread" : "notifications"
          }}
        </span>

        @if (currentUser) {
          <div class="dropdown">
            <a
              class="nav-link dropdown-toggle text-white user-name-link"
              href="#"
              role="button"
              data-bs-toggle="dropdown"
              aria-expanded="false"
              style="cursor: pointer"
            >
              <span class="material-symbols-outlined me-2 user-icon"
                >account_circle</span
              >
              <span>{{ currentUser.name }}</span>
            </a>

            <ul class="dropdown-menu dropdown-menu-end">
              <li>
                <a class="dropdown-item" routerLink="/perfil">Mi perfil</a>
              </li>
              <li>
                <a class="dropdown-item" routerLink="mis-compras"
                  >Mis compras</a
                >
              </li>
              <li>
                <a class="dropdown-item" routerLink="/configuracion"
                  >Configuración</a
                >
              </li>
              <li><a class="dropdown-item" routerLink="/admin">Admin</a></li>
              <li>
                <a class="dropdown-item" routerLink="/favoritos">Favoritos</a>
              </li>
              <li><hr class="dropdown-divider" /></li>
              <li>
                <a
                  class="dropdown-item"
                  (click)="logout()"
                  style="cursor: pointer"
                  >Cerrar sesión</a
                >
              </li>
            </ul>
          </div>
        } @else {
          <button
            class="btn btn-login rounded-pill text-nowrap"
            routerLink="/login"
          >
            Iniciar sesión
          </button>
        }
      </div>
    </div>
  </div>
</nav>

<div
  class="offcanvas offcanvas-end"
  data-bs-scroll="true"
  tabindex="-1"
  id="offcanvasWithBothOptions"
  aria-labelledby="offcanvasWithBothOptionsLabel"
>
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasWithBothOptionsLabel">
      Notificaciones
    </h5>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="offcanvas"
      aria-label="Close"
    ></button>
  </div>
  <div class="offcanvas-body">
    <app-notification></app-notification>
  </div>
</div>
